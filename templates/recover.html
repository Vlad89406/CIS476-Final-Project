<!DOCTYPE html>
<html>
<head>
    <title>MyPass - Recover Master Password</title>
</head>
<body>
    <h1>Recover Master Password</h1>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <ul>
          {% for category, message in messages %}
            <li><strong>{{ category }}:</strong> {{ message }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    {% endwith %}

    <form method="POST">
        <label>Email:</label><br>
        <input type="email" name="email" required><br><br>

        {% if user %}
            <p><strong>Question 1:</strong> {{ user.question1 }}</p>
            <p><strong>Question 2:</strong> {{ user.question2 }}</p>
            <p><strong>Question 3:</strong> {{ user.question3 }}</p>
        {% else %}
            <p>Answer your three security questions to reset your master password.</p>
        {% endif %}

        <label>Answer 1:</label><br>
        <input type="text" name="answer1" required><br>

        <label>Answer 2:</label><br>
        <input type="text" name="answer2" required><br>

        <label>Answer 3:</label><br>
        <input type="text" name="answer3" required><br><br>

        <label>New Master Password:</label><br>
        <input type="password" name="new_password" required><br><br>

        <button type="submit">Reset Password</button>
    </form>

    <p><a href="{{ url_for('login') }}">Back to Login</a></p>
</body>
</html>
